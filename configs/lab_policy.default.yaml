policy_name: "HendzelLab"
policy_version: "2026-02-25"
require_override_reason: true

# Replace these hashes for production deployments.
# Default passphrases:
# - instructor: instructor-passphrase
# - research: research-passphrase
role_auth:
  instructor: "$2b$12$EOnRFRvO1ft6FEzdQOVHG.9jycO4bnYwd2/d30.XMZ/arZT5w7uUy"
  research: "$2b$12$bzBNWHJrjAeZYsON8fmXbeTKobeC6ZcHnllnq5FWksKdLW02KUMFy"

roles:
  student:
    description: "Undergraduate — guided workflow, locked parameters"
    allowed_recipes: [nuclear_intensity, puncta_counting]
    export: PASS_ONLY
    allow_overrides: false
    allow_manual_segmentation_params: false
    allow_batch_without_preview: false
    allow_raw_mask_export: false
    require_tournament: true
    max_parameter_deviation: 0.0

  instructor:
    description: "Graduate student / postdoc — full access with audit trail"
    allowed_recipes: [nuclear_intensity, puncta_counting, colocalization]
    export: PASS_WARN
    allow_overrides: true
    allow_manual_segmentation_params: true
    allow_batch_without_preview: true
    allow_raw_mask_export: true
    require_tournament: false
    max_parameter_deviation: null

  research:
    description: "PI / senior researcher — unrestricted"
    allowed_recipes: ALL
    export: ALL
    allow_overrides: true
    allow_manual_segmentation_params: true
    allow_batch_without_preview: true
    allow_raw_mask_export: true
    require_tournament: false
    max_parameter_deviation: null

recipes:
  nuclear_intensity:
    locked_params:
      background_method: annulus
      flatfield: off
    student_editable_params:
      - expected_nucleus_diameter_px
    bounds:
      expected_nucleus_diameter_px:
        min: 5
        max: 80
    guardrails:
      min_nuclei_for_export: 30
      max_cv_area_percent: 80
      require_dna_channel_set: true
      max_saturated_fraction: 0.005

  puncta_counting:
    locked_params: {}
    student_editable_params: []
    bounds: {}
    guardrails: {}

  colocalization:
    locked_params: {}
    student_editable_params: []
    bounds: {}
    guardrails: {}
